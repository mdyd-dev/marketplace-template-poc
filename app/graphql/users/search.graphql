query users(
  $id: ID,
  $ids: [ID!],
  $email: String,
  $username: String,
  $slug: String,
  $limit: Int = 1,
  $valid_for: Int = 1,
  $with_token: Boolean = false,
  $sort_order: SortOrderEnum = ASC){
  users(
    per_page: $limit
    filter: {
      email: { value: $email }
      id:    { value: $id value_in: $ids }
      properties: [
        { name: "username", value: $username },
        { name: "slug", value: $slug }
      ]
    }
    sort: [{ id: { order: $sort_order  } }]
  ){
    total_entries
    results {
      id
      email
      created_at
      username: property(name: "username")
      uuid: property(name: "uuid")
      slug: property(name: "slug")
      first_name: property(name: "first_name")
      last_name: property(name: "last_name")
      token: temporary_token(valid_for: $valid_for) @include(if: $with_token)

      profile: related_model(model_schema_name: "profile" join_on_property: "uuid" foreign_property: "uuid"){
        name: property(name: "name")
        uuid: property(name: "uuid")
        slug: property(name: "slug")
        created_at
        id
        avatar: related_model(model_schema_name: "photo", join_on_property: "user_uuid", foreign_property: "object_uuid", filter: { properties: { name: "photo_type", value: "avatar"}}) {
          photo: property_upload(name: "photo") {
            url
            versions
          }
        }
      }
    }
  }
}
