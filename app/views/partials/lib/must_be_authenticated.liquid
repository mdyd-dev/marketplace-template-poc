{% liquid
  unless context.current_user or context.session.reset_password_session_user_id
    include 'lib/flash/publish', error: 'app.errors.unauthenticated'

    assign return_to = context.location.href
    session return_to = return_to

    redirect_to '/sessions/new'
    break
  else
    function current_user = 'lib/data/queries/users/find', id: context.current_user.id

    return current_user.profile
  endunless
%}
